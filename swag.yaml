openapi: 3.0.0
info:
  title: 'Бекенд Venari'
  contact:
    email: kupryashin.stepan@yandex.ru
  version: 3.0.0
servers:
  -
    url: 'https://venari.backend.rfld.ru'
    description: 'Боевой сервер'
paths:
  /api/register:
    post:
      tags:
        - UserController
      summary: 'Метод регистрации'
      operationId: 482fd8cbb98dc3225fa0e7ac40c1abe6
      requestBody:
        $ref: '#/components/requestBodies/RegisterRequest'
      responses:
        '200':
          description: 'Ответ при успешном выполнении запроса'
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/registerUser'
  /api/login:
    post:
      tags:
        - UserController
      summary: 'метод авторизации пользователя. возвращает токен'
      operationId: afd167661891a2c4c1b49a04643b9223
      requestBody:
        $ref: '#/components/requestBodies/LoginRequest'
      responses:
        '200':
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/loginUser'
  /api/chats:
    get:
      tags:
        - ChatController
      summary: "Метод получения всех чатов пользователя. Отсортированы в обратном порядке по времени последнего сообщения\n(самый поздний - первый)"
      operationId: d819b7e183bc1e432868877421b66e93
      responses:
        '200':
          description: 'Ответ при успешном выполнении запроса'
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/getChats'
  '/api/chats/personal/{userID}':
    get:
      tags:
        - ChatController
      summary: 'Метод получения сообщений 1-1 по id пользователя'
      operationId: 0de9b4d1d6303bad5628f21455852e95
      parameters:
        -
          name: userID
          description: 'id пользователя'
          required: true
      responses:
        '200':
          description: 'Ответ при успешном выполнении запроса'
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/getMessagesByUserID'
  '/api/chats/group/{chatID}':
    get:
      tags:
        - ChatController
      summary: 'Метод получения сообщений чата по id чата'
      operationId: 1c707390fd2f758bf4928dd979a31940
      parameters:
        -
          name: chatID
          description: 'id чата'
          required: true
      responses:
        '200':
          description: 'Ответ при успешном выполнении запроса'
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/getChatMessagesByChatID'
  /api/comments/send-comment:
    post:
      tags:
        - CommentController
      summary: 'Метод отправки комментария'
      operationId: e0fb87a1130be57faf66f1ca0405bdb8
      requestBody:
        $ref: '#/components/requestBodies/SendCommentRequest'
      responses:
        '200':
          description: 'Ответ при успешном выполнении запроса'
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/sendComment'
  /api/messages/send-message:
    post:
      tags:
        - MessageController
      summary: 'Метод отправки сообщений'
      operationId: 4bd87a3a7705f49799ee91b062338872
      requestBody:
        $ref: '#/components/requestBodies/SendMessageRequest'
      responses:
        '200':
          description: 'Ответ при успешном выполнении запроса'
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/sendMessage'
  /api/posts:
    get:
      tags:
        - PostController
      summary: 'Метод получения всех постов'
      operationId: 73071356cdd139f116db7436d9da6497
      responses:
        '200':
          description: 'Ответ при успешном выполнении запроса'
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/getPosts'
  '/api/posts/{id}':
    get:
      tags:
        - PostController
      summary: 'Метод получения поста по его id (подробная страница)'
      operationId: 575616ce88c4119bb7a6c703f83cb6ee
      parameters:
        -
          name: id
          description: 'id поста'
          required: true
      responses:
        '200':
          description: 'Ответ при успешном выполнении запроса'
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/getPostByID'
  /api/vacancies:
    get:
      tags:
        - VacancyController
      summary: 'Метод получения всех вакансий'
      operationId: a75f8d08e0e49f2a76fffdbf7a64b395
      responses:
        '200':
          description: 'Ответ при успешном выполнении запроса'
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/getVacancies'
  '/api/vacancies/{id}':
    get:
      tags:
        - VacancyController
      summary: 'Метод получения подробной информации о вакансии по id'
      operationId: eaa6d5b5a84d934bfc97c0df706eddd2
      parameters:
        -
          name: id
          description: 'id вакансии'
          required: true
      responses:
        '200':
          description: 'Ответ при успешном выполнении запроса'
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/getVacancyByID'
components:
  schemas:
    messageType:
      type: string
      enum:
        - message
        - chatMessage
    registerUser:
      properties:
        success:
          type: boolean
          example: 'true'
        user:
          $ref: '#/components/schemas/user'
        access_token:
          type: string
      type: object
    loginUser:
      properties:
        success:
          type: boolean
          example: 'true'
        user:
          $ref: '#/components/schemas/user'
        token:
          type: string
      type: object
    getChats:
      properties:
        success:
          type: boolean
          example: 'true'
        response:
          type: array
          items:
            $ref: '#/components/schemas/previewChat'
      type: object
    getMessagesByUserID:
      properties:
        success:
          type: boolean
          example: 'true'
        response:
          type: array
          items:
            $ref: '#/components/schemas/message'
      type: object
    getChatMessagesByChatID:
      properties:
        success:
          type: boolean
          example: 'true'
        response:
          type: array
          items:
            $ref: '#/components/schemas/chatMessage'
      type: object
    sendComment:
      properties:
        success:
          type: boolean
          example: 'true'
        response:
          type: array
          items:
            $ref: '#/components/schemas/comment'
      type: object
    sendMessage:
      properties:
        success:
          type: boolean
          example: 'true'
        response:
          type: array
          items:
            $ref: '#/components/schemas/message'
      type: object
    getPosts:
      properties:
        success:
          type: boolean
          example: 'true'
        posts:
          type: array
          items:
            $ref: '#/components/schemas/post'
      type: object
    getPostByID:
      properties:
        success:
          type: boolean
          example: 'true'
        post:
          $ref: '#/components/schemas/detailPost'
      type: object
    getVacancies:
      properties:
        success:
          type: boolean
          example: 'true'
        response:
          type: array
          items:
            $ref: '#/components/schemas/vacancy'
      type: object
    getVacancyByID:
      properties:
        success:
          type: boolean
          example: 'true'
        response:
          type: array
          items:
            $ref: '#/components/schemas/detailVacancy'
      type: object
    vacancy:
      properties:
        id:
          type: integer
        department:
          $ref: '#/components/schemas/department'
        position:
          $ref: '#/components/schemas/position'
        description:
          type: string
        is_online:
          type: boolean
        has_social_support:
          type: boolean
        schedule:
          type: string
        is_flexible:
          type: boolean
        link_to_test_document:
          type: string
        city:
          $ref: '#/components/schemas/city'
        is_closed:
          type: boolean
        is_outer:
          type: boolean
        created_at:
          format: date
        updated_at:
          format: date
        responsibilities:
          type: string
        requirements:
          type: string
        conditions:
          type: string
        additional:
          type: string
          nullable: true
        experience:
          $ref: '#/components/schemas/experience'
        employment:
          $ref: '#/components/schemas/employment'
        lower_salary:
          type: number
          format: float
          nullable: true
        higher_salary:
          type: number
          format: float
          nullable: true
        image:
          $ref: '#/components/schemas/image'
      type: object
    detailVacancy:
      properties:
        id:
          type: integer
        department:
          $ref: '#/components/schemas/detailDepartment'
        position:
          $ref: '#/components/schemas/position'
        description:
          type: string
        is_online:
          type: boolean
        has_social_support:
          type: boolean
        schedule:
          type: string
        is_flexible:
          type: boolean
        link_to_test_document:
          type: string
        city:
          $ref: '#/components/schemas/city'
        is_closed:
          type: boolean
        is_outer:
          type: boolean
        created_at:
          format: date
        updated_at:
          format: date
        responsibilities:
          type: string
        requirements:
          type: string
        conditions:
          type: string
        additional:
          type: string
          nullable: true
        experience:
          $ref: '#/components/schemas/experience'
        employment:
          $ref: '#/components/schemas/employment'
        lower_salary:
          type: number
          format: float
          nullable: true
        higher_salary:
          type: number
          format: float
          nullable: true
        image:
          $ref: '#/components/schemas/image'
        skills:
          type: array
          items:
            $ref: '#/components/schemas/skill'
      type: object
    detailDepartment:
      properties:
        id:
          type: integer
        name:
          type: string
        created_at:
          format: date
        updated_at:
          format: date
        company:
          $ref: '#/components/schemas/detailCompany'
      type: object
    department:
      properties:
        id:
          type: integer
        name:
          type: string
        created_at:
          format: date
        updated_at:
          format: date
        company:
          $ref: '#/components/schemas/company'
      type: object
    detailCompany:
      properties:
        id:
          type: integer
        name:
          type: string
        description:
          type: string
        established_at:
          format: date
        nick_name:
          type: string
        created_at:
          format: date
        updated_at:
          format: date
        image:
          $ref: '#/components/schemas/image'
        building:
          $ref: '#/components/schemas/building'
      type: object
    company:
      properties:
        id:
          type: integer
        name:
          type: string
        description:
          type: string
        established_at:
          format: date
        nick_name:
          type: string
        created_at:
          format: date
        updated_at:
          format: date
        image_id:
          type: integer
          nullable: true
        building_id:
          type: integer
          nullable: true
      type: object
    building:
      properties:
        id:
          type: integer
        name:
          type: string
        created_at:
          format: date
        updated_at:
          format: date
        street:
          $ref: '#/components/schemas/street'
      type: object
    street:
      properties:
        id:
          type: integer
        name:
          type: string
        created_at:
          format: date
        updated_at:
          format: date
        city:
          $ref: '#/components/schemas/detailCity'
      type: object
    skill:
      properties:
        id:
          type: integer
        name:
          type: string
        created_at:
          format: date
        updated_at:
          format: date
      type: object
    city:
      properties:
        id:
          type: integer
        name:
          type: string
        created_at:
          format: date
        updated_at:
          format: date
        country_id:
          type: integer
          nullable: true
      type: object
    detailCity:
      properties:
        id:
          type: integer
        name:
          type: string
        created_at:
          format: date
        updated_at:
          format: date
        country:
          $ref: '#/components/schemas/country'
      type: object
    country:
      properties:
        id:
          type: integer
        name:
          type: string
        created_at:
          format: date
        updated_at:
          format: date
      type: object
    image:
      properties:
        id:
          type: integer
        image:
          type: string
        description:
          type: string
        created_at:
          format: date
        updated_at:
          format: date
      type: object
    position:
      properties:
        id:
          type: integer
        name:
          type: string
        created_at:
          format: date
        updated_at:
          format: date
      type: object
    employment:
      properties:
        id:
          type: integer
        name:
          type: string
        created_at:
          format: date
        updated_at:
          format: date
      type: object
    experience:
      properties:
        id:
          type: integer
        name:
          type: string
        created_at:
          format: date
        updated_at:
          format: date
      type: object
    sources:
      type: string
      enum:
        - venari
        - habr
    post:
      properties:
        id:
          type: integer
        title:
          type: string
        text:
          type: string
        user:
          $ref: '#/components/schemas/detailUser'
        attributes:
          $ref: '#/components/schemas/attributes'
        likes:
          type: integer
        description:
          type: string
        source:
          $ref: '#/components/schemas/sources'
        user_name:
          type: string
        source_url:
          type: string
          format: url
        created_at:
          format: date
        updated_at:
          format: date
      type: object
    detailPost:
      properties:
        id:
          type: integer
        title:
          type: string
        text:
          type: string
        user:
          $ref: '#/components/schemas/detailUser'
        attributes:
          $ref: '#/components/schemas/attributes'
        likes:
          type: integer
        description:
          type: string
        source:
          $ref: '#/components/schemas/sources'
        user_name:
          type: string
        source_url:
          type: string
          format: url
        created_at:
          format: date
        updated_at:
          format: date
        comments:
          type: array
          items:
            $ref: '#/components/schemas/detailComment'
        images:
          type: array
          items:
            $ref: '#/components/schemas/image'
      type: object
    attributes: {  }
    user:
      properties:
        id:
          type: integer
        name:
          type: string
        email:
          type: string
        workingStatus_id:
          type: integer
        position_id:
          type: integer
        sex:
          type: boolean
        date_of_birth:
          format: date
        hrable_id:
          type: integer
          nullable: true
        hrable_type:
          type: string
        image_id:
          type: integer
          nullable: true
        created_at:
          format: date
        updated_at:
          format: date
      type: object
    previewChat:
      properties:
        name:
          type: string
        avatar:
          type: string
        body:
          type: string
        updated_at:
          type: string
          format: date
        type:
          $ref: '#/components/schemas/messageType'
        id:
          description: "'id может быть как чата, так и пользователя. Смотри type"
          type: integer
      type: object
    message:
      properties:
        id:
          type: integer
        from_id:
          type: integer
        to_id:
          type: integer
        body:
          type: string
        created_at:
          format: date
        updated_at:
          format: date
      type: object
    chatMessage:
      properties:
        id:
          type: integer
        owner_id:
          type: integer
        chat_id:
          type: integer
        body:
          type: string
        created_at:
          format: date
        updated_at:
          format: date
      type: object
    comment:
      properties:
        id:
          type: integer
        text:
          type: string
        post_id:
          type: integer
        parent_id:
          description: 'id комментария, на который отвечаем'
          type: integer
          nullable: true
        created_at:
          format: date
        updated_at:
          format: date
      type: object
    detailComment:
      properties:
        id:
          type: integer
        text:
          type: string
        post_id:
          type: integer
          nullable: true
        all_children:
          description: 'Массив ответов'
          type: array
          items:
            $ref: '#/components/schemas/comment'
        parent_id:
          description: 'id комментария, на который отвечаем'
          type: integer
          nullable: true
        created_at:
          format: date
        updated_at:
          format: date
      type: object
    detailUser:
      properties:
        id:
          type: integer
        name:
          type: string
        email:
          type: string
        workingStatus_id:
          type: integer
        position_id:
          type: integer
        sex:
          type: boolean
        date_of_birth:
          format: date
        hrable:
          $ref: '#/components/schemas/HR'
        image:
          $ref: '#/components/schemas/image'
        created_at:
          format: date
        updated_at:
          format: date
      type: object
    HR:
      properties:
        id:
          type: integer
        company_id:
          type: integer
        created_at:
          format: date
        updated_at:
          format: date
      type: object
    detailHR:
      properties:
        id:
          type: integer
        company:
          $ref: '#/components/schemas/company'
        created_at:
          format: date
        updated_at:
          format: date
      type: object
  requestBodies:
    LoginRequest:
      content:
        application/json:
          schema:
            properties:
              email:
                type: string
              password:
                type: string
            type: object
    RegisterRequest:
      content:
        application/json:
          schema:
            properties:
              email:
                type: string
              password:
                type: string
              login:
                type: string
            type: object
    SendCommentRequest:
      content:
        application/json:
          schema:
            properties:
              text:
                type: string
              postID:
                type: integer
              parentID:
                description: "id комментария, на который отвечаем. Необязательный\n * параметр"
                type: integer
            type: object
    SendMessageRequest:
      content:
        application/json:
          schema:
            properties:
              toID:
                type: integer
              body:
                type: string
              type:
                type: string
              files:
                type: array
                items:
                  description: 'Массив файлов, без base64'
                  type: string
                  format: binary
              images:
                type: array
                items:
                  description: 'Массив изображений, без base64'
                  type: string
                  format: binary
            type: object
externalDocs:
  description: 'Как документировать этот код'
  url: 'https://zircote.github.io/swagger-php/guide/annotations.html'
